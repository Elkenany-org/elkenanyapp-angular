{"ast":null,"code":"import { EventEmitter } from '@angular/core';\nimport { Banner_test, logo_test } from '@app/modules/home/data';\nimport { map } from 'rxjs';\nimport { co_Search_Form_Data } from '@app/@core/interfaces/companies-guid/co-home-data';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../../../../@core/services/modules/companies-guide/companies-guide.service\";\nimport * as i2 from \"@angular/router\";\nimport * as i3 from \"@angular/common\";\nimport * as i4 from \"@app/@core/services/Banners-logos.service\";\nimport * as i5 from \"@angular/platform-browser\";\nimport * as i6 from \"../../../../@shared/components/app/banner-logos/banner-logos.component\";\nimport * as i7 from \"../../../../@shared/components/app/horizontal-search/horizontal-search.component\";\nimport * as i8 from \"../../../../@shared/components/app/card/card.component\";\nexport let CoGuideHomeComponent = /*#__PURE__*/(() => {\n  class CoGuideHomeComponent {\n    constructor(companiesGuideService, route, router, activatedRoute, location, BannerLogoService, titleService) {\n      this.companiesGuideService = companiesGuideService;\n      this.route = route;\n      this.router = router;\n      this.activatedRoute = activatedRoute;\n      this.location = location;\n      this.BannerLogoService = BannerLogoService;\n      this.titleService = titleService;\n      this.complenght = new EventEmitter();\n      this.loading = true;\n      this.carousel_banner = Banner_test;\n      this.carousel_logos = logo_test;\n      this.filterData = {\n        type: \"\",\n        sort: \"\",\n        search: \"\"\n      };\n    }\n\n    ngOnInit() {\n      this.h_search_form = co_Search_Form_Data; //set initial data to horizontal component \n\n      this.activatedRoute.data.pipe(map(data => {\n        return data;\n      })).subscribe(res => {\n        this.Companies_Home_Data = res['resolve'];\n        this.BannerLogoService.setBanner(this.Companies_Home_Data.banners);\n        this.BannerLogoService.setLogo(this.Companies_Home_Data.logos);\n        this.loading = false;\n      });\n      this.route.params.subscribe(params => {\n        if (params['type'] == '0') {\n          this.type = '';\n        } else {\n          this.type = params['type'];\n        }\n\n        this.companiesGuideService.Filter_list(this.type + '').subscribe(res => {\n          var _a, _b, _c, _d, _e, _f;\n\n          this.typeAr = (_b = (_a = res.data) === null || _a === void 0 ? void 0 : _a.sectors.find(i => i.selected == 1)) === null || _b === void 0 ? void 0 : _b.name;\n          this.filterData['sector'] = ((_d = (_c = res.data) === null || _c === void 0 ? void 0 : _c.sectors.find(i => i.selected == 1)) === null || _d === void 0 ? void 0 : _d.id) + '';\n          this.type = this.filterData['sector'];\n          this.titleService.setTitle(' الدليل قسم ' + this.typeAr); //override data to match the data format of horizontal components\n\n          this.h_search_form.controls.find(i => i.role === \"sector\").option = (_e = res.data) === null || _e === void 0 ? void 0 : _e.sectors;\n          this.h_search_form.controls.find(i => i.role === \"sort\").option = (_f = res.data) === null || _f === void 0 ? void 0 : _f.sort;\n          this.h_search_form.controls.find(i => i.role === \"sort\").option.find(i => i.id !== 0).selected = 0;\n          this.h_search_form.controls.find(i => i.role === \"sort\").option.unshift({\n            \"id\": 0,\n            \"name\": \"اختر الترتيب\",\n            \"value\": ''\n          });\n        });\n      });\n    }\n\n    filter(value) {\n      let flag = false;\n      let sort = '';\n      this.route.params.subscribe(params => {\n        // this.filterData['sector'] = params['type']\n        switch (value.type) {\n          case \"sector\":\n            this.filterData['sector'] = value.id;\n            this.h_search_form.controls.find(i => i.role === \"sort\").option.find(i => i.id == 0).selected = 1;\n            flag = true;\n            break;\n\n          case \"sort\":\n            this.filterData['sort'] = value.id;\n            this.h_search_form.controls.find(i => i.role === \"sort\").option.find(i => i.id === value.id).selected = 1;\n            this.h_search_form.controls.find(i => i.role === \"sort\").option.find(i => i.id !== value.id).selected = 0;\n            sort = this.h_search_form.controls.find(i => i.role === \"sort\").option.find(i => i.id === value.id).value;\n            break;\n\n          case \"search\":\n            this.filterData['search'] = value.name;\n            break;\n\n          default:\n            // \n            break;\n        }\n\n        this.companiesGuideService.CompaniesHome(this.filterData['sector'], sort, this.filterData['search']).subscribe(res => {\n          var _a;\n\n          this.Companies_Home_Data = res;\n          this.BannerLogoService.setBanner(this.Companies_Home_Data.banners);\n          this.BannerLogoService.setLogo(this.Companies_Home_Data.logos);\n          this.loading = false; // change url params without reloade with new state\n\n          this.type = this.filterData['sector'];\n          this.h_search_form.controls.find(i => i.role === \"sector\").option = this.Companies_Home_Data.sectors;\n          this.typeAr = (_a = this.Companies_Home_Data.sectors.find(i => i.selected == 1)) === null || _a === void 0 ? void 0 : _a.name;\n\n          if (flag) {\n            this.titleService.setTitle(' الدليل قسم ' + this.typeAr);\n          } // console.log(this.Companies_Home_Data.sub_sections.length)\n\n\n          this.location.go(`/companies-guide/${this.type}`);\n        });\n      });\n    }\n\n    navigate(id) {\n      var _a, _b, _c;\n\n      let len = ((_c = (_b = (_a = this.Companies_Home_Data) === null || _a === void 0 ? void 0 : _a.sub_sections) === null || _b === void 0 ? void 0 : _b.find(i => i.id == parseInt(id))) === null || _c === void 0 ? void 0 : _c.companies_count) + '';\n      this.complenght.emit(len);\n      this.router.navigate([`companies-guide/${this.type}/companies/${this.type}`], {\n        queryParams: {\n          page: 1,\n          sub: id\n        }\n      });\n    }\n\n  }\n\n  CoGuideHomeComponent.ɵfac = function CoGuideHomeComponent_Factory(t) {\n    return new (t || CoGuideHomeComponent)(i0.ɵɵdirectiveInject(i1.CompaniesGuideService), i0.ɵɵdirectiveInject(i2.ActivatedRoute), i0.ɵɵdirectiveInject(i2.Router), i0.ɵɵdirectiveInject(i2.ActivatedRoute), i0.ɵɵdirectiveInject(i3.Location), i0.ɵɵdirectiveInject(i4.BannersLogoservice), i0.ɵɵdirectiveInject(i5.Title));\n  };\n\n  CoGuideHomeComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: CoGuideHomeComponent,\n    selectors: [[\"app-co-guide-home\"]],\n    outputs: {\n      complenght: \"complenght\"\n    },\n    decls: 23,\n    vars: 12,\n    consts: [[1, \"main__content__body\"], [1, \"container\"], [1, \"mt-3\", \"mt-lg-0\"], [3, \"loading\", \"type\"], [1, \"banner__header\"], [1, \"container-fluid\", \"one-full-slider-banner\"], [\"id\", \"image-slider\", 1, \"splide\"], [1, \"splide__track\"], [1, \"partners\", \"slider\"], [1, \"container-fluid\", \"logos__holder\"], [\"dir\", \"rtl\", 1, \"partners-slider\"], [\"id\", \"partnerCarousel\", 1, \"splide\"], [3, \"data\", \"newItemEvent\"], [1, \"container\", \"global__container\"], [1, \"title-box\"], [1, \"title\"], [1, \"sections-number\"], [3, \"data\", \"flag\", \"maincard\", \"loading\", \"navigation\"]],\n    template: function CoGuideHomeComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0);\n        i0.ɵɵelementStart(1, \"div\", 1);\n        i0.ɵɵelementStart(2, \"h1\", 2);\n        i0.ɵɵtext(3);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(4, \"app-banners-logo\", 3);\n        i0.ɵɵelement(5, \"app-banners-logo\", 3);\n        i0.ɵɵelementStart(6, \"header\", 4);\n        i0.ɵɵelementStart(7, \"div\", 5);\n        i0.ɵɵelementStart(8, \"div\", 6);\n        i0.ɵɵelementStart(9, \"div\", 7);\n        i0.ɵɵelement(10, \"div\", 6);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(11, \"article\", 8);\n        i0.ɵɵelementStart(12, \"div\", 9);\n        i0.ɵɵelementStart(13, \"section\", 10);\n        i0.ɵɵelement(14, \"section\", 11);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(15, \"app-horizontal-search\", 12);\n        i0.ɵɵlistener(\"newItemEvent\", function CoGuideHomeComponent_Template_app_horizontal_search_newItemEvent_15_listener($event) {\n          return ctx.filter($event);\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(16, \"article\", 13);\n        i0.ɵɵelementStart(17, \"section\", 14);\n        i0.ɵɵelementStart(18, \"h2\", 15);\n        i0.ɵɵtext(19);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(20, \"span\", 16);\n        i0.ɵɵtext(21);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(22, \"app-card\", 17);\n        i0.ɵɵlistener(\"navigation\", function CoGuideHomeComponent_Template_app_card_navigation_22_listener($event) {\n          return ctx.navigate($event);\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(3);\n        i0.ɵɵtextInterpolate(ctx.h_search_form.title);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"loading\", ctx.loading)(\"type\", \"banner\");\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"loading\", ctx.loading)(\"type\", \"logo\");\n        i0.ɵɵadvance(10);\n        i0.ɵɵproperty(\"data\", ctx.h_search_form);\n        i0.ɵɵadvance(4);\n        i0.ɵɵtextInterpolate(ctx.typeAr);\n        i0.ɵɵadvance(2);\n        i0.ɵɵtextInterpolate1(\"\", ctx.Companies_Home_Data == null ? null : ctx.Companies_Home_Data.sub_sections == null ? null : ctx.Companies_Home_Data.sub_sections.length, \" \\u0642\\u0633\\u0645\");\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"data\", ctx.Companies_Home_Data == null ? null : ctx.Companies_Home_Data.sub_sections)(\"flag\", false)(\"maincard\", true)(\"loading\", ctx.loading);\n      }\n    },\n    directives: [i6.BannerLogosComponent, i7.HorizontalSearchComponent, i8.CardComponent],\n    styles: [\"\"]\n  });\n  return CoGuideHomeComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}