{"ast":null,"code":"import { map } from 'rxjs';\nimport { market_Search_Form_Data } from '@app/@core/interfaces/market/market-home-data';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@app/@core/services/modules/market/market.service\";\nimport * as i2 from \"@angular/router\";\nimport * as i3 from \"@angular/common\";\nimport * as i4 from \"@app/@core/services/Banners-logos.service\";\nimport * as i5 from \"@angular/platform-browser\";\nimport * as i6 from \"../../../../@shared/components/app/banner-logos/banner-logos.component\";\nimport * as i7 from \"../../../../@shared/components/app/horizontal-search/horizontal-search.component\";\nimport * as i8 from \"../../../../@shared/components/app/card/card.component\";\nimport * as i9 from \"ngx-pagination\";\n\nfunction MarketHomeComponent_li_20_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"li\");\n  }\n}\n\nconst _c0 = function () {\n  return [];\n};\n\nconst _c1 = function (a1) {\n  return {\n    itemsPerPage: 1,\n    currentPage: a1\n  };\n};\n\nexport let MarketHomeComponent = /*#__PURE__*/(() => {\n  class MarketHomeComponent {\n    constructor(MarketService, router, activatedRoute, location, BannerLogoService, titleService) {\n      this.MarketService = MarketService;\n      this.router = router;\n      this.activatedRoute = activatedRoute;\n      this.location = location;\n      this.BannerLogoService = BannerLogoService;\n      this.titleService = titleService;\n      this.flagFirsttime = false;\n      this.loading = true;\n      this.page = {\n        last_page: 0,\n        current_page: 0\n      }; // active:boolean=true;\n\n      this.filterData = {\n        type: \"\",\n        sort: \"\",\n        search: \"\",\n        page: '',\n        date: \"\"\n      };\n    }\n\n    ngOnInit() {\n      this.h_search_form = market_Search_Form_Data; //set initial data to horizontal component \n\n      this.titleService.setTitle(' اعلانات السوق ');\n      this.activatedRoute.queryParamMap.subscribe(params => {\n        if (this.flagFirsttime) {\n          this.page.current_page = +params.get('page');\n          this.MarketService.market(this.type, params.get('sort') + '', this.filterData['search'], this.filterData['date'], this.page.current_page + '').subscribe(res => {\n            var _a, _b, _c;\n\n            this.page.current_page = (_a = res.data) === null || _a === void 0 ? void 0 : _a.current_page;\n            this.page.last_page = (_b = res.data) === null || _b === void 0 ? void 0 : _b.last_page;\n            this.Market_Data = (_c = res.data) === null || _c === void 0 ? void 0 : _c.data;\n          });\n        }\n      });\n      this.activatedRoute.params.subscribe(params => {\n        this.type = params['type'];\n        this.MarketService.Filter_list(this.type).subscribe(res => {\n          var _a, _b;\n\n          this.h_search_form.controls.find(i => i.role === \"sector\").option = (_a = res.data) === null || _a === void 0 ? void 0 : _a.sectors;\n          this.h_search_form.controls.find(i => i.role === \"sort\").option = (_b = res.data) === null || _b === void 0 ? void 0 : _b.sort;\n          this.h_search_form.controls.find(i => i.role === \"sort\").option.find(i => i.id !== 2).selected = 0;\n          this.h_search_form.controls.find(i => i.role === \"sort\").option.find(i => i.id === 2).selected = 1;\n          this.type = this.h_search_form.controls.find(i => i.role === \"sector\").option.find(i => i.selected == 1).id;\n          this.location.go(`/market/${this.type}?sort=&page=1`);\n\n          if (!this.flagFirsttime) {\n            this.type = this.h_search_form.controls.find(i => i.role === \"sector\").option.find(i => i.selected == 1).id;\n            this.location.go(`/market/${this.type}`, `sort=&page=1`);\n          }\n        });\n      });\n      this.activatedRoute.data.pipe(map(data => {\n        return data['resolve'].data;\n      })).subscribe(res => {\n        this.Market_Data = res.data;\n        this.page.current_page = res.current_page;\n        this.page.last_page = res.last_page;\n        this.BannerLogoService.setBanner(res.banners);\n        this.BannerLogoService.setLogo(res.logos);\n        this.loading = false;\n        this.flagFirsttime = true;\n      }); // this.MarketService.my_ads(this.type).subscribe(res => {\n      //   console.log(res)\n      // })\n    }\n\n    filter(value) {\n      this.activatedRoute.params.subscribe(params => {\n        this.filterData['sector'] = params['type'];\n        this.filterData['date'] = \"\";\n\n        switch (value.type) {\n          case \"sector\":\n            this.filterData['sector'] = value.id;\n            break;\n\n          case \"sort\":\n            this.filterData['sort'] = value.id;\n            this.h_search_form.controls.find(i => i.role === \"sort\").option.find(i => i.id === value.id).selected = 1;\n            this.h_search_form.controls.find(i => i.role === \"sort\").option.find(i => i.id !== value.id).selected = 0;\n            break;\n\n          case \"date\":\n            this.filterData['date'] = value.name; // console.log('date'+value.name);    \n\n            break;\n\n          case \"search\":\n            this.filterData['search'] = value.name; // console.log('date'+value.name);    \n\n            break;\n\n          default:\n            // \n            break;\n        }\n      });\n      this.MarketService.market(this.filterData['sector'], this.filterData['sort'], this.filterData['search'], this.filterData['date'], '').subscribe(res => {\n        var _a, _b, _c, _d, _e, _f;\n\n        this.page.current_page = (_a = res.data) === null || _a === void 0 ? void 0 : _a.current_page;\n        this.page.last_page = (_b = res.data) === null || _b === void 0 ? void 0 : _b.last_page;\n        this.Market_Data = (_c = res.data) === null || _c === void 0 ? void 0 : _c.data;\n        this.BannerLogoService.setBanner((_d = res.data) === null || _d === void 0 ? void 0 : _d.banners);\n        this.BannerLogoService.setLogo((_e = res.data) === null || _e === void 0 ? void 0 : _e.logos);\n        this.h_search_form.controls.find(i => i.role === \"sector\").option = (_f = res.data) === null || _f === void 0 ? void 0 : _f.sectors;\n        this.type = this.filterData['sector']; // this.location.go(`market/${this.type}`);\n\n        this.router.navigate(['/market/', this.filterData['sector']], {\n          queryParams: {\n            sort: this.filterData['sort'],\n            page: this.page.current_page\n          }\n        }); // this.location.go(`/market/${ this.filterData['sector'] }`,`sort=${this.filterData['sort']}&page=1`);\n      });\n    }\n\n    navigate(id) {\n      // console.log(id)\n      this.router.navigate([`/market/${this.type}/ad_details/${id}`]);\n    }\n\n    next_page(page) {\n      // this.filterData[\"page\"] = page+''\n      // this.filterData[\"sector\"] =this.type\n      this.router.navigate(['/market/', this.type], {\n        queryParams: {\n          sort: this.filterData['sort'],\n          page: page\n        }\n      });\n      window.scroll(0, 0);\n    }\n\n  }\n\n  MarketHomeComponent.ɵfac = function MarketHomeComponent_Factory(t) {\n    return new (t || MarketHomeComponent)(i0.ɵɵdirectiveInject(i1.MarketService), i0.ɵɵdirectiveInject(i2.Router), i0.ɵɵdirectiveInject(i2.ActivatedRoute), i0.ɵɵdirectiveInject(i3.Location), i0.ɵɵdirectiveInject(i4.BannersLogoservice), i0.ɵɵdirectiveInject(i5.Title));\n  };\n\n  MarketHomeComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: MarketHomeComponent,\n    selectors: [[\"app-market-home\"]],\n    decls: 23,\n    vars: 19,\n    consts: [[1, \"container\"], [1, \"mt-3\", \"mt-lg-0\"], [3, \"loading\", \"type\"], [1, \"page__tabs\", \"nb-0\", \"container\"], [1, \"tabs__list\"], [1, \"list__item\", \"list__item-2\"], [\"routerLink\", \"./\", 1, \"list__link\", \"active\"], [1, \"list__link\", 3, \"routerLink\"], [3, \"data\", \"newItemEvent\"], [1, \"global__container\", \"container\"], [3, \"data\", \"newscard\", \"loading\", \"flag\", \"navigation\"], [1, \"row\", \"pagination__container\"], [1, \"col-12\"], [1, \"pagination\"], [4, \"ngFor\", \"ngForOf\"], [\"previousLabel\", \"\", \"nextLabel\", \"\", 3, \"maxSize\", \"click\", \"pageChange\"]],\n    template: function MarketHomeComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0);\n        i0.ɵɵelementStart(1, \"h1\", 1);\n        i0.ɵɵtext(2);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(3, \"app-banners-logo\", 2);\n        i0.ɵɵelement(4, \"app-banners-logo\", 2);\n        i0.ɵɵelementStart(5, \"div\", 3);\n        i0.ɵɵelementStart(6, \"ul\", 4);\n        i0.ɵɵelementStart(7, \"li\", 5);\n        i0.ɵɵelementStart(8, \"a\", 6);\n        i0.ɵɵtext(9, \"\\u0627\\u0644\\u0633\\u0648\\u0642\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(10, \"li\", 5);\n        i0.ɵɵelementStart(11, \"a\", 7);\n        i0.ɵɵtext(12, \"\\u0627\\u0639\\u0644\\u0627\\u0646\\u0627\\u062A\\u0643\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(13, \"app-horizontal-search\", 8);\n        i0.ɵɵlistener(\"newItemEvent\", function MarketHomeComponent_Template_app_horizontal_search_newItemEvent_13_listener($event) {\n          return ctx.filter($event);\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(14, \"article\", 9);\n        i0.ɵɵelementStart(15, \"app-card\", 10);\n        i0.ɵɵlistener(\"navigation\", function MarketHomeComponent_Template_app_card_navigation_15_listener($event) {\n          return ctx.navigate($event);\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(16, \"div\", 11);\n        i0.ɵɵelementStart(17, \"div\", 12);\n        i0.ɵɵelementStart(18, \"div\", 13);\n        i0.ɵɵelementStart(19, \"ul\");\n        i0.ɵɵtemplate(20, MarketHomeComponent_li_20_Template, 1, 0, \"li\", 14);\n        i0.ɵɵpipe(21, \"paginate\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(22, \"pagination-controls\", 15);\n        i0.ɵɵlistener(\"click\", function MarketHomeComponent_Template_pagination_controls_click_22_listener() {\n          return ctx.next_page(ctx.page.current_page);\n        })(\"pageChange\", function MarketHomeComponent_Template_pagination_controls_pageChange_22_listener($event) {\n          return ctx.page.current_page = $event;\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(2);\n        i0.ɵɵtextInterpolate(ctx.h_search_form.title);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"loading\", ctx.loading)(\"type\", \"banner\");\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"loading\", ctx.loading)(\"type\", \"logo\");\n        i0.ɵɵadvance(7);\n        i0.ɵɵpropertyInterpolate1(\"routerLink\", \"/market/\", ctx.type, \"/my-ads\");\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"data\", ctx.h_search_form);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"data\", ctx.Market_Data)(\"newscard\", true)(\"loading\", ctx.loading)(\"flag\", false);\n        i0.ɵɵadvance(5);\n        i0.ɵɵproperty(\"ngForOf\", i0.ɵɵpipeBind2(21, 13, i0.ɵɵpureFunction0(16, _c0).constructor(ctx.page.last_page), i0.ɵɵpureFunction1(17, _c1, ctx.page.current_page)));\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"maxSize\", 7);\n      }\n    },\n    directives: [i6.BannerLogosComponent, i2.RouterLinkWithHref, i7.HorizontalSearchComponent, i8.CardComponent, i3.NgForOf, i9.PaginationControlsComponent],\n    pipes: [i9.PaginatePipe],\n    styles: [\".ngx-pagination[_ngcontent-%COMP%]   .current[_ngcontent-%COMP%]{background:#FFBB33!important}\"]\n  });\n  return MarketHomeComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}